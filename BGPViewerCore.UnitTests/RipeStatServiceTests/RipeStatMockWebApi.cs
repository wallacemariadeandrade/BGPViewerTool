using System;
using System.Text.Json;
using System.Threading.Tasks;
using BGPViewerCore.Service;

namespace BGPViewerCore.UnitTests.RipeStatServiceTests
{
    public class RipeStatMockWebApi : RipeStatWebApi
    {
        private JsonDocument Error() => JsonDocument.Parse(@"{ ""messages"": [ [ ""error"", ""An error has occurred."" ] ], ""see_also"": [], ""version"": ""1.3"", ""data_call_name"": ""as-overview"", ""data_call_status"": ""supported - based on 2.1"", ""cached"": false, ""data"": {}, ""query_id"": ""20211214102018-40d28a05-e60e-4321-8399-e27d0e17a282"", ""process_time"": 11, ""server_id"": ""app120"", ""build_version"": ""live.2021.12.10.55"", ""status"": ""error"", ""status_code"": 400, ""time"": ""2021-12-14T10:20:18.465498"" }");
        public override JsonDocument RetrieveAsnDetails(int asNumber)
        {
            if(asNumber == 1299)
                return JsonDocument.Parse(@"{ ""messages"": [], ""see_also"": [], ""version"": ""1.3"", ""data_call_name"": ""as-overview"", ""data_call_status"": ""supported - based on 2.1"", ""cached"": false, ""data"": { ""type"": ""as"", ""resource"": ""1299"", ""block"": { ""resource"": ""1-1876"", ""desc"": ""Assigned by ARIN"", ""name"": ""IANA 16-bit Autonomous System (AS) Numbers Registry"" }, ""holder"": ""TWELVE99 - Telia Company AB"", ""announced"": true, ""query_starttime"": ""2021-12-13T16:00:00"", ""query_endtime"": ""2021-12-13T16:00:00"" }, ""query_id"": ""20211214003817-09165af2-7e35-4145-b14b-190a8ea7715a"", ""process_time"": 130, ""server_id"": ""app111"", ""build_version"": ""live.2021.12.10.55"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-14T00:38:17.356572"" }");
            if(asNumber == 264075)
                return JsonDocument.Parse(@"{ ""messages"": [], ""see_also"": [], ""version"": ""1.3"", ""data_call_name"": ""as-overview"", ""data_call_status"": ""supported - based on 2.1"", ""cached"": false, ""data"": { ""type"": ""as"", ""resource"": ""264075"", ""block"": { ""resource"": ""263680-264604"", ""desc"": ""Assigned by LACNIC"", ""name"": ""IANA 32-bit Autonomous System (AS) Numbers Registry"" }, ""holder"": ""K1 Telecom e Multimidia LTDA"", ""announced"": true, ""query_starttime"": ""2021-12-14T00:00:00"", ""query_endtime"": ""2021-12-14T00:00:00"" }, ""query_id"": ""20211214101331-1e196b72-5b09-452b-a5ee-07200f0f62d8"", ""process_time"": 78, ""server_id"": ""app145"", ""build_version"": ""live.2021.12.10.55"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-14T10:13:31.351844"" }");
            return Error();
        }

        public override Task<JsonDocument> RetrieveAsnDetailsAsync(int asNumber)
            => Task.FromResult(RetrieveAsnDetails(asNumber));

        public override JsonDocument RetrieveAsnPrefixes(int asNumber)
        {
            if(asNumber == 53181)
                return JsonDocument.Parse(@"{ ""messages"": [ [ ""info"", ""Results exclude routes with very low visibility (less than 10 RIS full-feed peers seeing)."" ] ], ""see_also"": [], ""version"": ""1.2"", ""data_call_name"": ""announced-prefixes"", ""data_call_status"": ""supported - connecting to ursa"", ""cached"": false, ""data"": { ""prefixes"": [ { ""prefix"": ""2804:113c:a000::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.78.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.68.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.74.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.66.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.175.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:9400::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:9000::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.160.0/20"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.173.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:8800::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.160.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.74.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.69.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.167.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.72.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.164.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.78.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.79.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.73.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:8000::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.65.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:fc00::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.68.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.165.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.166.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.161.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.169.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.168.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.172.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c::/32"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.75.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.72.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:8400::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:8c00::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:9c00::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.76.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:a400::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.166.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.174.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:a800::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.160.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.64.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.174.0/23"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""2804:113c:9800::/38"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""201.33.170.0/24"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] }, { ""prefix"": ""191.241.64.0/20"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] } ], ""query_starttime"": ""2021-12-01T00:00:00"", ""query_endtime"": ""2021-12-15T00:00:00"", ""resource"": ""53181"", ""latest_time"": ""2021-12-15T00:00:00"", ""earliest_time"": ""2000-08-01T00:00:00"" }, ""query_id"": ""20211215112250-015428e7-f7f2-414c-bfe0-91b509e562ff"", ""process_time"": 4325, ""server_id"": ""app147"", ""build_version"": ""live.2021.12.10.55"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-15T11:22:54.813528"" }");
            if(asNumber == 262950)
                return JsonDocument.Parse(@"{ ""messages"": [ [ ""info"", ""Results exclude routes with very low visibility (less than 10 RIS full-feed peers seeing)."" ] ], ""see_also"": [], ""version"": ""1.2"", ""data_call_name"": ""announced-prefixes"", ""data_call_status"": ""supported - connecting to ursa"", ""cached"": false, ""data"": { ""prefixes"": [ { ""prefix"": ""186.235.120.0/21"", ""timelines"": [ { ""starttime"": ""2021-12-01T00:00:00"", ""endtime"": ""2021-12-15T00:00:00"" } ] } ], ""query_starttime"": ""2021-12-01T00:00:00"", ""query_endtime"": ""2021-12-15T00:00:00"", ""resource"": ""262950"", ""latest_time"": ""2021-12-15T00:00:00"", ""earliest_time"": ""2000-08-01T00:00:00"" }, ""query_id"": ""20211215112308-3a51b3d3-5238-4824-abb5-1f56c5e0bf96"", ""process_time"": 73, ""server_id"": ""app147"", ""build_version"": ""live.2021.12.10.55"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-15T11:23:08.172395"" }");
            return Error();
        }

        public override Task<JsonDocument> RetrieveAsnPrefixesAsync(int asNumber)
            => Task.FromResult(RetrieveAsnPrefixes(asNumber));

        public override JsonDocument RetrieveIpDetails(string ipAddress)
        {
            if(ipAddress == "191.241.64.0")
                return JsonDocument.Parse(@"{ ""messages"": [], ""see_also"": [], ""version"": ""1.0"", ""data_call_name"": ""network-info"", ""data_call_status"": ""supported"", ""cached"": false, ""data"": { ""asns"": [ ""53181"" ], ""prefix"": ""191.241.64.0/24"" }, ""query_id"": ""20211214105900-963b39b6-58ab-451d-a2d5-dc924ebbeea8"", ""process_time"": 83, ""server_id"": ""app126"", ""build_version"": ""live.2021.12.10.55"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-14T10:59:01.012383"" }");
            if(ipAddress == "2001:db8::")
                return JsonDocument.Parse(@"{ ""messages"": [], ""see_also"": [], ""version"": ""1.0"", ""data_call_name"": ""network-info"", ""data_call_status"": ""supported"", ""cached"": false, ""data"": { ""asns"": [ ""131111"" ], ""prefix"": ""2000::/3"" }, ""query_id"": ""20211214112026-f2f13557-909d-4e4e-9545-d8664e61ad33"", ""process_time"": 80, ""server_id"": ""app116"", ""build_version"": ""live.2021.12.10.55"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-14T11:20:26.104886"" }");
            return Error();
        }

        public override Task<JsonDocument> RetrieveIpDetailsAsync(string ipAddress)
            => Task.FromResult(RetrieveIpDetails(ipAddress));

        public override JsonDocument RetrievePrefixDetails(string prefix, byte cidr)
        {
            var p = $"{prefix}/{cidr}";
            if(p == "191.241.64.0/20")
                return JsonDocument.Parse(@"{ ""messages"": [], ""see_also"": [ { ""relation"": ""less-specific"", ""resource"": ""191.241.64.0/20"" } ], ""version"": ""1.3"", ""data_call_name"": ""prefix-overview"", ""data_call_status"": ""supported - connecting to ursa"", ""cached"": false, ""data"": { ""is_less_specific"": false, ""announced"": true, ""asns"": [ { ""asn"": 53181, ""holder"": ""K2 Telecom e Multimidia LTDA ME"" } ], ""related_prefixes"": [ ""191.241.64.0/20"" ], ""resource"": ""191.241.64.0/24"", ""type"": ""prefix"", ""block"": { ""resource"": ""191.0.0.0/8"", ""desc"": ""Administered by LACNIC"", ""name"": ""IANA IPv4 Address Space Registry"" }, ""actual_num_related"": 1, ""query_time"": ""2021-12-16T00:00:00"", ""num_filtered_out"": 0 }, ""query_id"": ""20211216093354-19c57233-da05-4fc2-a6f8-b8799fc8ebf8"", ""process_time"": 118, ""server_id"": ""app132"", ""build_version"": ""live.2021.12.15.56"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-16T09:33:54.548663"" }");
            if(p == "2804::113c/32")
                return JsonDocument.Parse(@"{ ""messages"": [], ""see_also"": [ { ""relation"": ""more-specific"", ""resource"": ""2804:0:8000::/33"" }, { ""relation"": ""more-specific"", ""resource"": ""2804:0:666::/48"" }, { ""relation"": ""more-specific"", ""resource"": ""2804:0:1800::/48"" }, { ""relation"": ""more-specific"", ""resource"": ""2804:0:1c00::/48"" }, { ""relation"": ""more-specific"", ""resource"": ""2804:0:5c00::/48"" }, { ""relation"": ""more-specific"", ""resource"": ""2804:0:6c00::/48"" } ], ""version"": ""1.3"", ""data_call_name"": ""prefix-overview"", ""data_call_status"": ""supported - connecting to ursa"", ""cached"": true, ""data"": { ""is_less_specific"": false, ""announced"": true, ""asns"": [ { ""asn"": 2716, ""holder"": ""Universidade Federal do Rio Grande do Sul"" } ], ""related_prefixes"": [ ""2804:0:8000::/33"", ""2804:0:666::/48"", ""2804:0:1800::/48"", ""2804:0:1c00::/48"", ""2804:0:5c00::/48"", ""2804:0:6c00::/48"" ], ""resource"": ""2804::/32"", ""type"": ""prefix"", ""block"": { ""resource"": ""2800::/12"", ""desc"": ""Designated to LACNIC on 03 October 2006 (Status: allocated; Note: 2800:0000::/23 was allocated on 2005-11-17. The more recent allocation (2006-10-03) incorporates the \nprevious allocation.)"", ""name"": ""IANA IPv6 Global Unicast Address Assignments"" }, ""actual_num_related"": 6, ""query_time"": ""2021-12-16T00:00:00"", ""num_filtered_out"": 0 }, ""query_id"": ""20211216092500-40257e40-17e6-40d2-82c3-9b99d35eaf40"", ""process_time"": 0, ""server_id"": ""app130"", ""build_version"": ""live.2021.12.15.56"", ""status"": ""ok"", ""status_code"": 200, ""time"": ""2021-12-16T09:25:00.766906"" }");
            return Error();
        }

        public override Task<JsonDocument> RetrievePrefixDetailsAsync(string prefix, byte cidr)
            => Task.FromResult(RetrievePrefixDetails(prefix, cidr));
    }
}